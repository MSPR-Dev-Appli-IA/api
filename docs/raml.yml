#%RAML 1.0
---
title: Arosaje API
baseUri: https://api.arosaje-stage.locascio.fr/api/{version}
mediaType: application/json
version: v1

/auth:
  /login:
    post:
      description: Allows to login
      body:
        application/json:
          type: UserLocal
      responses:
        200:
          body:
            application/json:
              type: UserResponse
        403:
          body:
            application/json:
              example: |
                {
                  "field": ["error"],
                  "message": ["Your are logged in"]
                }
        404:
          body:
            application/json:
              example: |
                {
                  "field": ["error"],
                  "message": ["L'email et/ou le mot de passe est incorrect"]
                }
  /logout:
    get:
      description: Allows to logout
      securedBy: [ cookie-auth ]
      responses:
        200:
        401:
          body:
            application/json:
              example: |
                {
                  "field": ["error"],
                  "message": ["Your are not logged in"]
                }
  /me:
    get:
      description: Allows to get user info
      securedBy: [ cookie-auth ]
      responses:
        200:
          body:
            application/json:
              type: UserResponse
        401:
          body:
            application/json:
              example: |
                {
                  "field": ["error"],
                  "message": ["Your are not logged in"]
                }

  /signup:
    post:
      description: Allows to create account
      body:
        application/json:
          type: UserForm
      responses:
        200:
          body:
            application/json:
              type: UserResponse
        403:
          body:
            application/json:
              example: |
                {
                  "field": ["error"],
                  "message": ["Your are always logged"]
                }
        500:
          body:
            application/json:
              example: |
                {
                  "field": ["email", "password"],
                  "message": ["MongoServerError: E11000 duplicate key error collection", "Le mot de passe doit être au minimum de 6 caractères"]
                }

types:
  UserForm:
    type: object
    properties:
      username: string
      firstname: string
      lastname: string
      email: string
      password: string
    example:
      email: "test@test.com"
      username: "Test"
      firstname: "Test"
      lastname: "Test"
      password: "Azerty"
  UserLocal:
    type: object
    properties:
      email: string
      password: string
    example:
      email: "test@test.com"
      password: "Azerty"
  UserResponse:
    type: object
    properties:
      username: string
      firstname: string
      lastname: string
      role: string
      created_at: datetime
      deleted_at: datetime?
      local: UserLocal[]

securitySchemes:
  cookie-auth:
    description: |
      Custom authentication scheme for jwt cookie.
    type:
      x-custom
    describedBy:
      headers:
        Cookie:
          description: |
            jwt
          type: string